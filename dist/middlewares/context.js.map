{"version":3,"file":"context.js","sourceRoot":"/","sources":["middlewares/context.ts"],"names":[],"mappings":";;;AACA,0CAA2C;AAG3C,SAA8B,UAAU,CAAE,GAAiC,EAAC,GAAY,EAAC,IAAiB;;QACxG,IAAI;YACF,IAAI,KAAK,GAAG,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAA;YACnD,IAAI,OAAW,CAAC;YAEhB,IAAI,KAAK,EAAE;gBACT,IAAG;oBACD,OAAO,GAAG,MAAM,IAAA,iBAAS,EAAC,KAAK,CAAC,CAAC;iBAClC;gBAAA,OAAM,CAAC,EAAC;oBACP,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,EAAE,CAAC,CAAA;iBAC9C;gBAED,MAAM,EAAE,GAAG,OAAO,CAAC,GAAG,CAAC;gBAEvB,MAAM,IAAI,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC;gBACzB,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC;gBAC9B,IAAI,EAAE,CAAA;aACP;SACF;QAAC,OAAO,GAAG,EAAE;YACZ,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;SAClB;IACH,CAAC;CAAA;AArBD,6BAqBC;AAAA,CAAC","sourcesContent":["import { NextFunction } from 'express';\nimport { verifyJwt } from '../utils/token';\nimport { Request,Response } from 'express';\n\nexport default async function setContext (req:Request & {user:{_id:string}},res:Response,next:NextFunction){\n  try {\n    let token = req.headers.authorization.split(' ')[1]\n    let decoded:any;\n\n    if (token) {\n      try{\n        decoded = await verifyJwt(token);\n      }catch(e){\n        throw new Error(`error decoding token: ${e}`)\n      }\n      \n      const id = decoded._id;\n      \n      const user = { _id: id };\n      user ? req.user = user : null;\n      next()\n    }\n  } catch (err) {\n    console.log(err);\n  }\n};\n"]}